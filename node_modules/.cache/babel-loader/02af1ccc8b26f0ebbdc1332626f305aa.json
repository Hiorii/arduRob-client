{"ast":null,"code":"import _regeneratorRuntime from\"/home/hiorii/Desktop/arduRob/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/home/hiorii/Desktop/arduRob/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/home/hiorii/Desktop/arduRob/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{initialState}from'./initialState';import axios from'axios';import{API_URL}from'../config';/* selectors */export var isUserFetched=function isUserFetched(_ref){var users=_ref.users;return users;};/* action name creator */var reducerName='users';var createActionName=function createActionName(name){return\"app/\".concat(reducerName,\"/\").concat(name);};/* action types */var AUTH=createActionName('AUTH');var LOGOUT=createActionName('LOGOUT');var FAILURE=createActionName('FAILURE');/* action creators */export var authUser=function authUser(payload){return{payload:payload,type:AUTH};};export var logoutUser=function logoutUser(payload){return{payload:payload,type:LOGOUT};};export var failFetch=function failFetch(payload){return{payload:payload,type:FAILURE};};/* thunk creators */export var signInWithGoogle=function signInWithGoogle(formData,history){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var googleData,googleToken,_yield$axios$post,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;googleData=formData.data.result;googleToken=formData.data.token;_context.next=5;return axios.post(\"\".concat(API_URL,\"/signGoogle\"),googleData);case 5:_yield$axios$post=_context.sent;data=_yield$axios$post.data;dispatch(authUser({data:_objectSpread(_objectSpread({},data),{},{token:googleToken})}));if(history.location.pathname==='/login'){history.push('/');}else{history.push(history.location.pathname);}window.location.reload();_context.next=15;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 15:case\"end\":return _context.stop();}}},_callee,null,[[0,12]]);}));return function(_x){return _ref2.apply(this,arguments);};}();};export var signIn=function signIn(formData,history){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var _yield$axios$post2,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.post(\"\".concat(API_URL,\"/signin\"),formData);case 3:_yield$axios$post2=_context2.sent;data=_yield$axios$post2.data;dispatch(authUser({data:data}));if(history.location.pathname==='/login'){history.push('/');}else{history.push(history.location.pathname);}window.location.reload();_context2.next=13;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](0);dispatch(failFetch(_context2.t0));case 13:case\"end\":return _context2.stop();}}},_callee2,null,[[0,10]]);}));return function(_x2){return _ref3.apply(this,arguments);};}();};export var signUp=function signUp(formData,history){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var _yield$axios$post3,data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return axios.post(\"\".concat(API_URL,\"/signup\"),formData);case 3:_yield$axios$post3=_context3.sent;data=_yield$axios$post3.data;dispatch(authUser({data:data}));if(history.location.pathname==='/login'){history.push('/');}else{history.push(history.location.pathname);}window.location.reload();_context3.next=13;break;case 10:_context3.prev=10;_context3.t0=_context3[\"catch\"](0);dispatch(failFetch(_context3.t0));case 13:case\"end\":return _context3.stop();}}},_callee3,null,[[0,10]]);}));return function(_x3){return _ref4.apply(this,arguments);};}();};export var userUpdate=function userUpdate(userData,history){return/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){var _yield$axios$put,data;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return axios.put(\"\".concat(API_URL,\"/user/data\"),userData);case 3:_yield$axios$put=_context4.sent;data=_yield$axios$put.data;dispatch(authUser({data:data}));history.push('/login');window.location.reload();_context4.next=13;break;case 10:_context4.prev=10;_context4.t0=_context4[\"catch\"](0);dispatch(failFetch(_context4.t0));case 13:case\"end\":return _context4.stop();}}},_callee4,null,[[0,10]]);}));return function(_x4){return _ref5.apply(this,arguments);};}();};/* reducer */export var reducer=function reducer(){var statePart=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};switch(action.type){case AUTH:{var _action$payload,_action$payload2;localStorage.setItem('profile',JSON.stringify(_objectSpread({},(_action$payload=action.payload)===null||_action$payload===void 0?void 0:_action$payload.data)));return _objectSpread(_objectSpread({},statePart),{},{authData:(_action$payload2=action.payload)===null||_action$payload2===void 0?void 0:_action$payload2.data,error:false});return statePart;}case LOGOUT:{localStorage.removeItem('profile');return _objectSpread(_objectSpread({},statePart),{},{users:null});}case FAILURE:{return _objectSpread(_objectSpread({},statePart),{},{error:true});}default:return statePart;}};","map":{"version":3,"sources":["/home/hiorii/Desktop/arduRob/client/src/redux/userRedux.js"],"names":["initialState","axios","API_URL","isUserFetched","users","reducerName","createActionName","name","AUTH","LOGOUT","FAILURE","authUser","payload","type","logoutUser","failFetch","signInWithGoogle","formData","history","dispatch","googleData","data","result","googleToken","token","post","location","pathname","push","window","reload","console","log","signIn","signUp","userUpdate","userData","put","reducer","statePart","action","localStorage","setItem","JSON","stringify","authData","error","removeItem"],"mappings":"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","sourcesContent":["import {initialState} from './initialState';\nimport axios from 'axios';\nimport {API_URL} from '../config';\n\n/* selectors */\nexport const isUserFetched = ({users}) => users;\n\n/* action name creator */\nconst reducerName = 'users';\nconst createActionName = name => `app/${reducerName}/${name}`;\n\n/* action types */\nconst AUTH = createActionName('AUTH');\nconst LOGOUT = createActionName('LOGOUT');\nconst FAILURE = createActionName('FAILURE');\n\n/* action creators */\nexport const authUser = payload => ({ payload, type: AUTH });\nexport const logoutUser = payload => ({ payload, type: LOGOUT });\nexport const failFetch = payload => ({ payload, type: FAILURE});\n\n/* thunk creators */\nexport const signInWithGoogle = (formData, history) => async (dispatch) => {\n  try {\n    const googleData = formData.data.result;\n    const googleToken = formData.data.token;\n    const { data } = await axios.post(`${API_URL}/signGoogle`, googleData);\n\n    dispatch(authUser({data:{...data, token: googleToken}}));\n    if(history.location.pathname === '/login') {\n      history.push('/');\n    } else {\n      history.push(history.location.pathname);\n    }\n    window.location.reload();\n  } catch (err) {\n    console.log(err);\n  }\n};\n\nexport const signIn = (formData, history) => async (dispatch) => {\n  try {\n    const { data } = await axios.post(`${API_URL}/signin`, formData);\n\n    dispatch(authUser({data: data}));\n    if(history.location.pathname === '/login') {\n      history.push('/');\n    } else {\n      history.push(history.location.pathname);\n    }\n    window.location.reload();\n  } catch (err) {\n    dispatch(failFetch(err));\n  }\n};\n\nexport const signUp = (formData, history) => async (dispatch) => {\n  try {\n    const { data } = await axios.post(`${API_URL}/signup`, formData);\n\n    dispatch(authUser({data: data}));\n    if(history.location.pathname === '/login') {\n      history.push('/');\n    } else {\n      history.push(history.location.pathname);\n    }\n    window.location.reload();\n  } catch (err) {\n    dispatch(failFetch(err));\n  }\n};\n\nexport const userUpdate = (userData, history) => async(dispatch) => {\n  try {\n    const {data} = await axios.put(`${API_URL}/user/data`, userData);\n    dispatch(authUser({data:data}));\n    history.push('/login');\n    window.location.reload();\n  } catch (err) {\n    dispatch(failFetch(err));\n  }\n};\n\n/* reducer */\nexport const reducer = (statePart = initialState, action = {}) => {\n  switch (action.type) {\n    case AUTH: {\n      localStorage.setItem('profile', JSON.stringify({...action.payload?.data}));\n\n      return {\n        ...statePart,\n        authData: action.payload?.data,\n        error: false,\n      };\n      return statePart;\n    }\n    case LOGOUT: {\n      localStorage.removeItem('profile');\n\n      return { ...statePart, users: null};\n    }\n    case FAILURE: {\n      return {\n        ...statePart,\n        error:  true,\n      };\n    }\n    default:\n      return statePart;\n  }\n};\n"]},"metadata":{},"sourceType":"module"}