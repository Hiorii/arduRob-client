{"ast":null,"code":"import _objectSpread from\"/home/hiorii/Desktop/arduRob/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/home/hiorii/Desktop/arduRob/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/hiorii/Desktop/arduRob/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{initialState}from'./initialState';import axios from'axios';import{API_URL}from'../config';/* selectors */export var getAllProducts=function getAllProducts(_ref){var products=_ref.products;return products;};/* action name creator */var reducerName='products';var createActionName=function createActionName(name){return\"app/\".concat(reducerName,\"/\").concat(name);};/* action types */var FETCH_START=createActionName('FETCH_START');var FETCH_SUCCESS=createActionName('FETCH_SUCCESS');var FETCH_ERROR=createActionName('FETCH_ERROR');var ADD_TO_CART=createActionName('ADD_TO_CART');/* action creators */export var fetchStarted=function fetchStarted(payload){return{payload:payload,type:FETCH_START};};export var fetchSuccess=function fetchSuccess(payload){return{payload:payload,type:FETCH_SUCCESS};};export var fetchError=function fetchError(payload){return{payload:payload,type:FETCH_ERROR};};export var addToCart=function addToCart(payload){return{payload:payload,type:ADD_TO_CART};};/* thunk creators */export var fetchProducts=function fetchProducts(products){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var res,_products;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(fetchStarted());_context.prev=1;_context.next=4;return axios.get(\"\".concat(API_URL,\"/products\"));case 4:res=_context.sent;_products=JSON.parse(localStorage.getItem('products'));dispatch(fetchSuccess(res.data));localStorage.setItem('products',JSON.stringify({data:res.data}));_products.forEach(function(product){return product.cartQuantiy=0;});_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](1);dispatch(fetchError(_context.t0.message||true));case 14:case\"end\":return _context.stop();}}},_callee,null,[[1,11]]);}));return function(_x){return _ref2.apply(this,arguments);};}();};/* reducer */export var reducer=function reducer(){var statePart=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};switch(action.type){case FETCH_START:{return _objectSpread(_objectSpread({},statePart),{},{loading:{active:true,error:false}});}case FETCH_SUCCESS:{action.payload.forEach(function(product){return product.cartQuantiy=0;});return _objectSpread(_objectSpread({},statePart),{},{loading:{active:false,error:false},data:action.payload});}case FETCH_ERROR:{return _objectSpread(_objectSpread({},statePart),{},{loading:{active:false,error:action.payload}});}case ADD_TO_CART:{var _products$data,_products$data2;var products=JSON.parse(localStorage.getItem('products'));var newStatePart=products===null||products===void 0?void 0:(_products$data=products.data)===null||_products$data===void 0?void 0:_products$data.map(function(product){if(product._id===action.payload._id){if(product.cartQuantiy===0){product.cartQuantiy=product.cartQuantiy+1;}return product;}else{return product;}});localStorage.setItem('products',JSON.stringify({data:newStatePart}));var updatedItems=products===null||products===void 0?void 0:(_products$data2=products.data)===null||_products$data2===void 0?void 0:_products$data2.filter(function(item){return item.cartQuantiy>0;});localStorage.setItem('cart',JSON.stringify(_objectSpread(_objectSpread({},statePart),{},{data:updatedItems})));return _objectSpread(_objectSpread({},statePart),{},{data:newStatePart});}default:return statePart;}};","map":{"version":3,"sources":["/home/hiorii/Desktop/arduRob/client/src/redux/productRedux.js"],"names":["initialState","axios","API_URL","getAllProducts","products","reducerName","createActionName","name","FETCH_START","FETCH_SUCCESS","FETCH_ERROR","ADD_TO_CART","fetchStarted","payload","type","fetchSuccess","fetchError","addToCart","fetchProducts","dispatch","get","res","JSON","parse","localStorage","getItem","data","setItem","stringify","forEach","product","cartQuantiy","message","reducer","statePart","action","loading","active","error","newStatePart","map","_id","updatedItems","filter","item"],"mappings":"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","sourcesContent":["import {initialState} from './initialState';\nimport axios from 'axios';\nimport {API_URL} from '../config';\n\n/* selectors */\nexport const getAllProducts = ({products}) => products;\n\n/* action name creator */\nconst reducerName = 'products';\nconst createActionName = name => `app/${reducerName}/${name}`;\n\n/* action types */\nconst FETCH_START = createActionName('FETCH_START');\nconst FETCH_SUCCESS = createActionName('FETCH_SUCCESS');\nconst FETCH_ERROR = createActionName('FETCH_ERROR');\nconst ADD_TO_CART = createActionName('ADD_TO_CART');\n\n/* action creators */\nexport const fetchStarted = payload => ({ payload, type: FETCH_START });\nexport const fetchSuccess = payload => ({ payload, type: FETCH_SUCCESS });\nexport const fetchError = payload => ({ payload, type: FETCH_ERROR });\nexport const addToCart = payload => ({ payload, type: ADD_TO_CART });\n\n/* thunk creators */\nexport const fetchProducts = (products) => {\n  return async (dispatch) => {\n    dispatch(fetchStarted());\n    try {\n      const res = await axios.get(`${API_URL}/products`);\n      const products = JSON.parse(localStorage.getItem('products'));\n      dispatch(fetchSuccess(res.data));\n      localStorage.setItem('products', JSON.stringify({data:res.data}));\n      products.forEach(product => product.cartQuantiy = 0);\n    } catch (err) {\n      dispatch(fetchError(err.message || true));\n    }\n  };\n};\n\n/* reducer */\nexport const reducer = (statePart = initialState, action = {}) => {\n  switch (action.type) {\n    case FETCH_START: {\n      return {\n        ...statePart,\n        loading: {\n          active: true,\n          error: false,\n        },\n      };\n    }\n    case FETCH_SUCCESS: {\n      action.payload.forEach(product => product.cartQuantiy = 0);\n      return {\n        ...statePart,\n        loading: {\n          active: false,\n          error: false,\n        },\n        data: action.payload,\n      };\n    }\n    case FETCH_ERROR: {\n      return {\n        ...statePart,\n        loading: {\n          active: false,\n          error: action.payload,\n        },\n      };\n    }\n    case ADD_TO_CART: {\n      const products = JSON.parse(localStorage.getItem('products'));\n      const newStatePart = products?.data?.map(product => {\n        if (product._id === action.payload._id) {\n          if(product.cartQuantiy === 0) {\n            product.cartQuantiy = product.cartQuantiy + 1;\n          }\n          return product;\n        } else {\n          return product;\n        }\n      });\n      localStorage.setItem('products', JSON.stringify({data: newStatePart}));\n      const updatedItems = products?.data?.filter(item=>item.cartQuantiy > 0);\n      localStorage.setItem('cart', JSON.stringify({...statePart,\n        data: updatedItems}));\n      return {\n        ...statePart,\n        data: newStatePart,\n      };\n    }\n    default:\n      return statePart;\n  }\n};\n"]},"metadata":{},"sourceType":"module"}